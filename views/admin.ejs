<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- ==================================================
     BASIC
================================================== -->
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- ==================================================
     FAVICONS & PWA
================================================== -->
<link
  rel="icon"
  type="image/png"
  href="/favicon-96x96.png"
  sizes="96x96"
/>
<link
  rel="icon"
  type="image/svg+xml"
  href="/favicon.svg"
/>
<link rel="shortcut icon" href="/favicon.ico" />

<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="/apple-touch-icon.png"
/>
<meta
  name="apple-mobile-web-app-title"
  content="‡§µ‡§æ‡§∞‡•ç‡§°-12 ‡§∞‡§æ‡§ú‡•Ä‡§µ ‡§ï‡•Å‡§Æ‡§æ‡§∞ ‡§∞‡§Ç‡§ú‡§®"
/>

<link rel="manifest" href="/site.webmanifest" />
<meta name="theme-color" content="#0A74DA" />

<!-- ==================================================
     GOOGLE FONTS
================================================== -->
<link
  href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
  rel="stylesheet"
/>

<!-- ==================================================
     PDF & SCREENSHOT LIBRARIES
================================================== -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    /* ===== HEADER ===== */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    h2 {
      margin: 0;
      color: #1f2937;
    }

    .actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      text-decoration: none;
      color: #fff;
      display: inline-block;
    }

    .btn-pdf {
      background: #4f46e5;
    }

    .btn-logout {
      background: #ef4444;
    }

    /* ===== TABLE WRAPPER ===== */
    .table-wrapper {
      background: #ffffff;
      border-radius: 10px;
      padding: 15px;
      overflow-x: auto;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th {
      background: #f1f5f9;
      color: #334155;
      text-align: left;
      padding: 12px;
      white-space: nowrap;
    }

    td {
      padding: 10px 12px;
      border-bottom: 1px solid #e5e7eb;
      white-space: nowrap;
    }

    tr:hover {
      background: #f9fafb;
    }

    .delete-btn,.fst-btn {
      background: #ef4444;
      color: #fff;
      padding: 6px 10px;
      border-radius: 5px;
      font-size: 12px;
      text-decoration: none;
    }
    .fst-btn{
      background-color: green;
      margin-left: 2px;
    }

    /* ===== FOOTER NOTE ===== */
    .footer-note {
      margin-top: 15px;
      font-size: 12px;
      color: #6b7280;
    }

    .fst-btn {
  padding: 6px 12px;
  border-radius: 6px;
  text-decoration: none;
  color: white;
  font-weight: 600;
}

.active-btn {
  background-color: #28a745; /* green */
  cursor: pointer;
}

.active-remove-btn {
  background-color: #dc3545; /* red */
  cursor: pointer;
}

.disabled-btn {
  background-color: #aaa;
  pointer-events: none;
  opacity: 0.6;
  cursor: not-allowed;
}

    /* ===== MOBILE RESPONSIVE ===== */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      table,
      thead,
      tbody,
      th,
      td,
      tr {
        display: block;
      }

      thead {
        display: none;
      }

      tr {
        background: #ffffff;
        margin-bottom: 15px;
        border-radius: 10px;
        padding: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      }

      td {
        border: none;
        padding: 6px 0;
        display: flex;
        justify-content: space-between;
        font-size: 13px;
      }

      td::before {
        content: attr(data-label);
        font-weight: 600;
        color: #475569;
      }
    }
  </style>
</head>

<body>

  <!-- ===== HEADER ===== -->
  <div class="header">
    <a href="/"><h2>üìã All Form Submissions</h2></a>
    <div class="actions">
      <button class="btn btn-pdf" onclick="downloadPDF()">‚¨á Download PDF</button>
      <a href="/admin/logout" class="btn btn-logout">Logout</a>
    </div>
  </div>

  <!-- ===== TABLE ===== -->
  <div class="table-wrapper" id="pdfArea">
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Aadhaar</th>
          <th>Father's Name</th>
          <th>Phone</th>
          <th>Class</th>
          <th>Competition</th>
          <th>Age</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <% forms.forEach(f => { %>
          <tr>
            <td data-label="Name"><%= f.name %></td>
            <td data-label="Aadhaar"><%= f.adharNumber %></td>
            <td data-label="Father"><%= f.fatherName %></td>
            <td data-label="Phone"><%= f.phone %></td>
            <td data-label="Class"><%= f.class %></td>
            <td data-label="Competition"><%= f.competition %></td>
            <td data-label="Age"><%= f.age %></td>
            <td data-label="Date"><%= f.createdAt.toLocaleDateString() %></td>
            <td data-label="Action">
              <a 
                href="/delete/<%= f._id %>" 
                class="delete-btn"
                onclick="return confirm('Are you sure you want to delete this entry?')">
                Delete
              </a>
           <% const isFirst = f.position === "1st"; %>

<% if (isFirst) { %>
  <a
    href="javascript:void(0)"
    class="fst-btn disabled-btn"
    onclick="return false;">
    1st
  </a>
<% } else { %>
  <a
    href="/admin/position/<%= f._id %>"
    class="fst-btn active-btn"
    onclick="return confirm('Are you sure you want to give 1st position to this entry?')">
    1st
  </a>
<% } %>

<a
  href="<%= isFirst ? `/admin/position/remove/${f._id}` : 'javascript:void(0)' %>"
  class="fst-btn <%= isFirst ? 'active-remove-btn' : 'disabled-btn' %>"
  <% if (isFirst) { %>
    onclick="return confirm('Are you sure you want to remove 1st position from this entry?')"
  <% } else { %>
    onclick="return false;"
  <% } %>
>
  Remove 1st
</a>


            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>

  <!-- ===== FOOTER NOTE ===== -->
  <div class="footer-note">
  ‚ö†Ô∏è ‡§®‡•ã‡§ü: ‡§ú‡§æ‡§®‡§¨‡•Ç‡§ù‡§ï‡§∞ ‡§ó‡§≤‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§¶‡•á‡§®‡•á ‡§™‡§∞ ‚Çπ500 ‡§§‡§ï ‡§ï‡§æ ‡§¶‡§Ç‡§° ‡§≤‡§ó‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§<br>
  üèÜ ‡§®‡•ã‡§ü: ‡§™‡•ç‡§∞‡§§‡§ø‡§Ø‡•ã‡§ó‡§ø‡§§‡§æ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§•‡§Æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§≠‡§æ‡§ó‡•Ä ‡§ï‡•ã ‡§™‡•ç‡§∞‡§•‡§Æ ‡§°‡§ø‡§µ‡•Ä‡§ú‡§® (1st Div) ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§
</div>

  <!-- ===== PDF SCRIPT ===== -->
  <script>
    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF("l", "pt", "a4");

      const element = document.getElementById("pdfArea");
      const canvas = await html2canvas(element, { scale: 2 });
      const imgData = canvas.toDataURL("image/png");

      const pdfWidth = pdf.internal.pageSize.getWidth();
      const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

      pdf.addImage(imgData, "PNG", 20, 20, pdfWidth - 40, pdfHeight);
      pdf.save("form-submissions.pdf");
    }
  </script>

</body>
</html>
